<span *ngIf="!fieldsLoading" class="mat-typography">

    <div class="ngxgHeaderToolbar" fxLayout="row">
        <div class="ngxgMaxWidth" fxFlex fxLayout="row" fxLayoutAlign="center center">
            <span fxFlex=41>

                <button *ngIf="filters.user.length > 1" mat-button [mdePopoverTriggerFor]="userFilter" class="ngxgButtonWhite">
                    Produtor
                </button>
                <button mat-button [mdePopoverTriggerFor]="farmFilter" class="ngxgButtonWhite">
                    Fazenda
                </button>
                <button mat-button [mdePopoverTriggerFor]="cropFilter" class="ngxgButtonWhite">
                    Cultura
                </button>
                <button mat-button [mdePopoverTriggerFor]="seasonFilter" class="ngxgButtonWhite">
                    Safra
                </button>

            </span>
            <span fxFlex="1 1 auto"></span>
            <span>
                <button mat-raised-button color="primary" class="mat-elevation-z0 ngxgHoverTransition">Criar Fazenda</button>
                <button mat-raised-button color="primary" class="mat-elevation-z0 ngxgHoverTransition">Criar Campo</button>
                <button mat-raised-button color="primary" class="mat-elevation-z0 ngxgHoverTransition">Criar Safra</button>
            </span>
        </div>
    </div>

    <div class="ngxgContent" fxLayout="row">
        <div class="ngxgMaxWidth" fxFlex fxLayout="row" fxLayoutGap="20px">

            <div id="fieldList" fxFlex=65 fxLayout="column" fxLayoutAlign="start">

                <mat-card *ngFor="let field of fields | filterBy: filterBy" fxFlex fxLayout="row" class="fieldCard mat-elevation-z0 ngxgHoverTransition"
                    [routerLink]="['/field']">

                    <div fxFlex="300px">
                        <img src="{{field.app.thumbnail}}" alt="Photo of a Shiba Inu">
                    </div>

                    <div fxFlex=28>
                        <h2>{{field.name}}</h2>
                        <!-- <h5>{{field.location.city.name}}, {{field.location.state.abbr}}</h5> -->

                        <h4>{{field.area.size}}</h4>
                        <h5>Área</h5>

                        <!-- <h4>{{field.app.weather.temperature}} - {{field.app.weather.summary}}</h4> -->
                        <h5>Condição agora</h5>

                        <span>
                            <!-- <h4>{{field.app.weather.sunrise}}</h4> -->
                            <h5>Amanhecer</h5>
                        </span>
                        <span>
                            <!-- <h4>{{field.app.weather.sunset}}</h4> -->
                            <h5>Pôr-do-Sol</h5>
                        </span>

                    </div>

                    <div fxFlex>
                        <h2>2017/2018 Algodão #000</h2>
                        <h5>Safra atual</h5>

                        <span>
                            <h4>Algodão</h4>
                            <h5>Cultura</h5>
                        </span>
                        <span>
                            <h4>PHY007</h4>
                            <h5>Variedade</h5>
                        </span>
                        <span class="clearBoth"></span>
                        <span>
                            <h4>12/10/2017</h4>
                            <h5>Data de colheita</h5>
                        </span>
                        <span>
                            <h4>02/02/2018</h4>
                            <h5>Previsão de colheita</h5>
                        </span>

                        <h4>R8 - Maturidade plena</h4>
                        <h5>Estádio atual</h5>
                    </div>

                </mat-card>
            </div>


            <div fxFlex>
                <div id="mapFieldsWrapper">
                    <div ngxgMap id="mapFields" [options]="{latitude: 31.7, longitude:-83.25, zoom:8.4, controls: {baseMaps: false, locate: false}, basemap: 'Light', fitMapTo: 'geojson'}">

                        <!-- <div ngxgGeoJson *ngFor="let field of fields" [options]="{id: field._id, geojson: field.extra.geojson}"></div> -->

                        <!-- <div ngxgMarker *ngFor="let field of fields" (click)="markerClicked($event)" [options]="{title: field.name, latitude: field.location.lat, longitude: field.location.lon, divIconOptions: field.extra.divIconOptions, fieldId: field._id}"></div> -->

                    </div>
                </div>

                <!-- <div id="mapFieldsWrapper">
                    <div id="mapFields" leaflet [leafletOptions]="map.options"></div>
                </div> -->
            </div>

        </div>

    </div>


    <!-- Filters -->

    <mde-popover #userFilter [mdePopoverCloseOnClick]="false" [mdePopoverOverlapTrigger]="false" [mdeFocusTrapEnabled]="false"
        mdePopoverPositionY="above">
        <mat-card style="max-height: 50vh; overflow: scroll; border:solid 1px #CCC">
            <mat-card-header>Produtores</mat-card-header>
            <mat-card-content>
                <mat-selection-list (selectionChange)="filterChange('user', user.selectedOptions)" #user>
                    <mat-list-option [checkboxPosition]="before" *ngFor="let user of filters.user" [value]="user.id">
                        {{user.name}}
                    </mat-list-option>
                </mat-selection-list>
            </mat-card-content>
        </mat-card>
    </mde-popover>

    <mde-popover #farmFilter [mdePopoverCloseOnClick]="false" [mdePopoverOverlapTrigger]="false" [mdeFocusTrapEnabled]="false"
        mdePopoverPositionY="above">
        <mat-card style="max-height: 50vh; overflow: scroll; border:solid 1px #CCC">
            <mat-card-header>Fazendas</mat-card-header>
            <mat-card-content>
                <mat-selection-list (selectionChange)="filterChange('farm', farm.selectedOptions)" #farm>
                    <mat-list-option [checkboxPosition]="before" *ngFor="let farm of filters.farm" [value]="farm.id">
                        {{farm.name}}
                    </mat-list-option>
                </mat-selection-list>
            </mat-card-content>
        </mat-card>
    </mde-popover>

    <mde-popover #cropFilter [mdePopoverCloseOnClick]="false" [mdePopoverOverlapTrigger]="false" [mdeFocusTrapEnabled]="false"
        mdePopoverPositionY="above">
        <mat-card style="max-height: 50vh; overflow: scroll">
            <mat-card-header>Culturas</mat-card-header>
            <mat-card-content>
                <mat-selection-list (selectionChange)="filterChange('crop', crop.selectedOptions)" #crop>
                    <mat-list-option [checkboxPosition]="before" *ngFor="let crop of filters.crop" [value]="crop.id">
                        {{crop.name}}
                    </mat-list-option>
                </mat-selection-list>
            </mat-card-content>
        </mat-card>
    </mde-popover>

    <mde-popover #seasonFilter [mdePopoverCloseOnClick]="false" [mdePopoverOverlapTrigger]="false" [mdeFocusTrapEnabled]="false"
        mdePopoverPositionY="above">
        <mat-card style="max-height: 50vh; overflow: scroll">
            <mat-card-header>Safras</mat-card-header>
            <mat-card-content>
                <mat-selection-list (selectionChange)="filterChange('season', season.selectedOptions)" #season>
                    <mat-list-option [checkboxPosition]="before" *ngFor="let season of filters.season" [value]="season.id">
                        {{season.name}}
                    </mat-list-option>
                </mat-selection-list>
            </mat-card-content>
        </mat-card>
    </mde-popover>

</span>